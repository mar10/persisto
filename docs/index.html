<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>persisto - v2.0.0-0</title>
	<meta name="description" content="Documentation for persisto - v2.0.0-0">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
	<script async src="assets/js/search.js" id="search-script"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">persisto - v2.0.0-0</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<h1>persisto - v2.0.0-0</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#persisto" id="persisto" style="color: inherit; text-decoration: none;">
					<h1>persisto</h1>
				</a>
				<p><a href="https://github.com/mar10/persisto/releases/latest"><img src="https://img.shields.io/github/release/mar10/persisto.svg" alt="GitHub version"></a>
					<a href="https://travis-ci.org/mar10/persisto"><img src="https://travis-ci.org/mar10/persisto.svg?branch=master" alt="Build Status"></a>
					<a href="https://www.npmjs.com/package/persisto"><img src="https://img.shields.io/npm/dm/persisto.svg" alt="npm"></a>
					<a href="https://www.jsdelivr.com/package/npm/persisto"><img src="https://data.jsdelivr.com/v1/package/npm/persisto/badge" alt="jsDelivr"></a>
					<a href="http://www.typescriptlang.org/"><img src="https://img.shields.io/badge/%3C%2F%3E-TypeScript-%230074c1.svg" alt="TypeScript"></a>
					<a href="https://github.com/mar10/grunt-yabs"><img src="https://img.shields.io/badge/released%20with-grunt--yabs-yellowgreen" alt="Released with: grunt-yabs"></a>
				<a href="https://stackoverflow.com/questions/tagged/persisto"><img src="https://img.shields.io/badge/StackOverflow-persisto-blue.svg" alt="StackOverflow: persisto"></a></p>
				<blockquote>
					<p>Persistent JavaScript objects and web forms using Web Storage.</p>
				</blockquote>
				<p>Features</p>
				<ul>
					<li>Persist JavaScript objects (<code>{...}</code>) to
						<a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API"><code>localStorage</code> / <code>sessionStorage</code></a>.<br>
						Use the <code>get()</code>/<code>set()</code> API for direct (even nested) access, hiding the need
					to convert from/to JSON.</li>
					<li>Cache access to
						<a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API"><code>localStorage</code> / <code>sessionStorage</code></a>
					(deferred writing appears to be 10-15 times faster) and remote backends.</li>
					<li>Make JavaScript objects editable in HTML forms.<br>
					Common use case: maintain persistent client settings and let users edit them.</li>
					<li>Optionally synchronize the data with a remote endpoint</li>
				</ul>
				<p><a href="https://mar10.github.io/persisto/">API Documentation</a></p>
				<p>Overview:</p>
				<p><img src="https://rawgit.com/mar10/persisto/no-jquery-ts/assets/architecture.png?raw=true" alt="sample"></p>
				<p>Requirements:</p>
				<ul>
					<li><strike>jQuery</strike> not required since v2.0</li>
					<li>Recent major browser (Internet Explorer is <strong>not</strong> supported!)</li>
				</ul>
				<p>Requirements for version 1.x:</p>
				<ul>
					<li>jQuery</li>
					<li>IE 8+ or any recent major browser</li>
				</ul>
				<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
					<h2>Usage</h2>
				</a>
				<p><a href="https://github.com/mar10/persisto/releases">Download the latest persisto.js</a>
					or include directly from CDN: <a href="https://www.jsdelivr.com/package/npm/persisto"><img src="https://data.jsdelivr.com/v1/package/npm/persisto/badge" alt=""></a> or
				<a href="https://unpkg.com/persisto@latest/dist/persisto.min.js">UNPKG</a>:</p>
				<pre><code class="language-html"><span style="color: #800000">&lt;script</span><span style="color: #000000FF"> </span><span style="color: #FF0000">src</span><span style="color: #000000FF">=</span><span style="color: #0000FF">&quot;//cdn.jsdelivr.net/npm/persisto@1/dist/persisto.min.js&quot;</span><span style="color: #800000">&gt;&lt;/script&gt;</span>
</code></pre>
				<p>then instantiate a <code>PersistentObject</code>:</p>
				<pre><code class="language-js"><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">store</span><span style="color: #000000"> = </span><span style="color: #795E26">PersistentObject</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;mySettings&quot;</span><span style="color: #000000">, {</span>
<span style="color: #000000">              </span><span style="color: #001080">defaults:</span><span style="color: #000000"> {</span>
<span style="color: #000000">                </span><span style="color: #001080">theme:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;default&quot;</span>
<span style="color: #000000">                }</span>
<span style="color: #000000">            });</span>
</code></pre>
				<p><code>store</code> now contains the data that was stored in <code>localStorage.mySettings</code> if
					present. Otherwise, <code>store</code> is initialized to the default values that we
				passed with the <code>.defaults</code> option.</p>
				<p>We can access data using <code>set</code>, <code>get</code>, <code>remove</code>, <code>reset</code>:</p>
				<pre><code class="language-js"><span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;theme&quot;</span><span style="color: #000000">);  </span><span style="color: #008000">// -&gt; &#039;default&#039;</span>
<span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #795E26">set</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;owner&quot;</span><span style="color: #000000">, {</span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;joe&quot;</span><span style="color: #000000">, </span><span style="color: #001080">age:</span><span style="color: #000000"> </span><span style="color: #098658">42</span><span style="color: #000000">});</span>
<span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #795E26">set</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;owner.role&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;manager&quot;</span><span style="color: #000000">);</span>
<span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;owner.age&quot;</span><span style="color: #000000">);  </span><span style="color: #008000">// -&gt; 42</span>
<span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #795E26">remove</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;owner.age&quot;</span><span style="color: #000000">);</span>
<span style="color: #008000">// -&gt; store now holds {theme: &quot;default&quot;, owner: {name: &quot;joe&quot;, role: &quot;manager&quot;}}</span>
</code></pre>
				<p>Every <em>modifying</em> operation triggers a deferred commit, so that shortly afterwards
				the data is serialized to JSON and written to <code>localStorage.mySettings</code>.</p>
				<p><strong>More:</strong></p>
				<ul>
					<li>Try the <a href="http://plnkr.co/edit/qcDmvN?p=preview">online example</a>.</li>
					<li>Run the <a href="https://rawgit.com/mar10/persisto/master/test/unit/test-core.html">unit tests</a>.</li>
				</ul>
				<a href="#synchronize-data-with-html-forms" id="synchronize-data-with-html-forms" style="color: inherit; text-decoration: none;">
					<h2>Synchronize Data with HTML Forms</h2>
				</a>
				<p>Form input elements can be synchronized with a <code>PersistentObject</code> by using two
					API calls.
				Example:</p>
				<pre><code class="language-js"><span style="color: #008000">// Maintain client&#039;s preferences and define some defaults:</span>
<span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">settingsStore</span><span style="color: #000000"> = </span><span style="color: #795E26">PersistentObject</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;mySettings&quot;</span><span style="color: #000000">, {</span>
<span style="color: #000000">        </span><span style="color: #001080">defaults:</span><span style="color: #000000"> {</span>
<span style="color: #000000">          </span><span style="color: #001080">nickname:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;anonymous&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">          </span><span style="color: #001080">theme:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;default&quot;</span>
<span style="color: #000000">          }</span>
<span style="color: #000000">      });</span>

<span style="color: #008000">// Initialize form elements with current data</span>
<span style="color: #001080">settingsStore</span><span style="color: #000000">.</span><span style="color: #795E26">writeToForm</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;#settingsForm&quot;</span><span style="color: #000000">);</span>

<span style="color: #008000">// Allow users to edit and save settings:</span>
<span style="color: #795E26">$</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;#settingsForm&quot;</span><span style="color: #000000">).</span><span style="color: #795E26">submit</span><span style="color: #000000">(</span><span style="color: #0000FF">function</span><span style="color: #000000">(</span><span style="color: #001080">event</span><span style="color: #000000">){</span>
<span style="color: #000000">  </span><span style="color: #008000">// ... maybe some validations here ...</span>
<span style="color: #000000">  </span><span style="color: #001080">settingsStore</span><span style="color: #000000">.</span><span style="color: #795E26">readFromForm</span><span style="color: #000000">(</span><span style="color: #0000FF">this</span><span style="color: #000000">);</span>
<span style="color: #000000">  </span><span style="color: #001080">event</span><span style="color: #000000">.</span><span style="color: #795E26">preventDefault</span><span style="color: #000000">();</span>
<span style="color: #000000">});</span>
</code></pre>
				<p>Supported elements are <code>&lt;input&gt;</code> (type text, checkbox, or radio), <code>&lt;textarea&gt;</code>,
					and <code>&lt;select&gt;</code> (single and multivalue).
				By convention, the html form <strong>must use element names that match the data properties</strong>.<br></p>
				<pre><code class="language-html"><span style="color: #800000">&lt;form</span><span style="color: #000000"> </span><span style="color: #FF0000">id</span><span style="color: #000000">=</span><span style="color: #0000FF">&quot;settingsForm&quot;</span><span style="color: #000000"> </span><span style="color: #FF0000">action</span><span style="color: #000000">=</span><span style="color: #0000FF">&quot;&quot;</span><span style="color: #800000">&gt;</span>
<span style="color: #000000">  </span><span style="color: #800000">&lt;label&gt;</span><span style="color: #000000">Nickname:</span><span style="color: #800000">&lt;input</span><span style="color: #000000"> </span><span style="color: #FF0000">name</span><span style="color: #000000">=</span><span style="color: #0000FF">&quot;nickname&quot;</span><span style="color: #000000"> </span><span style="color: #FF0000">type</span><span style="color: #000000">=</span><span style="color: #0000FF">&quot;text&quot;</span><span style="color: #000000"> </span><span style="color: #FF0000">value</span><span style="color: #000000">=</span><span style="color: #0000FF">&quot;&quot;</span><span style="color: #000000"> </span><span style="color: #800000">/&gt;&lt;/label&gt;&lt;br&gt;</span>
<span style="color: #000000">  </span><span style="color: #800000">&lt;label&gt;</span><span style="color: #000000">Theme:</span>
<span style="color: #000000">    </span><span style="color: #800000">&lt;fieldset&gt;</span>
<span style="color: #000000">      </span><span style="color: #800000">&lt;label&gt;</span><span style="color: #000000"> </span><span style="color: #800000">&lt;input</span><span style="color: #000000"> </span><span style="color: #FF0000">name</span><span style="color: #000000">=</span><span style="color: #0000FF">&quot;theme&quot;</span><span style="color: #000000"> </span><span style="color: #FF0000">type</span><span style="color: #000000">=</span><span style="color: #0000FF">&quot;radio&quot;</span><span style="color: #000000"> </span><span style="color: #FF0000">value</span><span style="color: #000000">=</span><span style="color: #0000FF">&quot;default&quot;</span><span style="color: #000000"> </span><span style="color: #800000">/&gt;</span><span style="color: #000000"> Standard </span><span style="color: #800000">&lt;/label&gt;&lt;br&gt;</span>
<span style="color: #000000">      </span><span style="color: #800000">&lt;label&gt;</span><span style="color: #000000"> </span><span style="color: #800000">&lt;input</span><span style="color: #000000"> </span><span style="color: #FF0000">name</span><span style="color: #000000">=</span><span style="color: #0000FF">&quot;theme&quot;</span><span style="color: #000000"> </span><span style="color: #FF0000">type</span><span style="color: #000000">=</span><span style="color: #0000FF">&quot;radio&quot;</span><span style="color: #000000"> </span><span style="color: #FF0000">value</span><span style="color: #000000">=</span><span style="color: #0000FF">&quot;light&quot;</span><span style="color: #000000"> </span><span style="color: #800000">/&gt;</span><span style="color: #000000"> Light </span><span style="color: #800000">&lt;/label&gt;&lt;br&gt;</span>
<span style="color: #000000">      </span><span style="color: #800000">&lt;label&gt;</span><span style="color: #000000"> </span><span style="color: #800000">&lt;input</span><span style="color: #000000"> </span><span style="color: #FF0000">name</span><span style="color: #000000">=</span><span style="color: #0000FF">&quot;theme&quot;</span><span style="color: #000000"> </span><span style="color: #FF0000">type</span><span style="color: #000000">=</span><span style="color: #0000FF">&quot;radio&quot;</span><span style="color: #000000"> </span><span style="color: #FF0000">value</span><span style="color: #000000">=</span><span style="color: #0000FF">&quot;dark&quot;</span><span style="color: #000000"> </span><span style="color: #800000">/&gt;</span><span style="color: #000000"> Dark </span><span style="color: #800000">&lt;/label&gt;</span>
<span style="color: #000000">    </span><span style="color: #800000">&lt;/fieldset&gt;</span>
<span style="color: #000000">  </span><span style="color: #800000">&lt;/label&gt;</span>
<span style="color: #000000">  </span><span style="color: #800000">&lt;button</span><span style="color: #000000"> </span><span style="color: #FF0000">type</span><span style="color: #000000">=</span><span style="color: #0000FF">&quot;Submit&quot;</span><span style="color: #800000">&gt;</span><span style="color: #000000">Submit</span><span style="color: #800000">&lt;/button&gt;</span>
<span style="color: #800000">&lt;/form&gt;</span>
</code></pre>
				<p>Note also that only fields are synchronized, that already existed in the storage
					data. Use the <code>addNew</code> option if <em>all</em> form fields should be evaluated and create
				new properties in the store object:</p>
				<pre><code class="language-js"><span style="color: #001080">settingsStore</span><span style="color: #000000">.</span><span style="color: #795E26">readFromForm</span><span style="color: #000000">(</span><span style="color: #0000FF">this</span><span style="color: #000000">, {</span>
<span style="color: #000000">  </span><span style="color: #001080">addNew:</span><span style="color: #000000"> </span><span style="color: #0000FF">true</span>
<span style="color: #000000">});</span>
</code></pre>
				<a href="#pros-and-cons" id="pros-and-cons" style="color: inherit; text-decoration: none;">
					<h2>Pros and Cons</h2>
				</a>
				<ul>
					<li><p>Any <code>PersistentObject</code> instance is stored as one monolythic JSON string.<br>
							<em>Persisto</em> deferres and collates these updates, but modifying a single
							property of a large data object still comes with some overhead.<br>
							Splitting data into several <code>PersistentObject</code>s may remedy the problem.<br>
							But if your data model is more like a table with hundredth&#39;s of rows, a
						responsive database backend may be a better choice.</p>
					</li>
					<li><p>Asynchronous operations bear the risk of potential conflicts.
						There is currently no builtin support for resolving those.</p>
					</li>
				</ul>
				<a href="#howtos" id="howtos" style="color: inherit; text-decoration: none;">
					<h1>HOWTOs</h1>
				</a>
				<a href="#storing-arrays" id="storing-arrays" style="color: inherit; text-decoration: none;">
					<h3>Storing Arrays</h3>
				</a>
				<p>Arrays are only a special form of plain JavaScript objects, so we can store and
				access them as top level type like this:</p>
				<pre><code class="language-js"><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">store</span><span style="color: #000000"> = </span><span style="color: #795E26">PersistentObject</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;mySettings&quot;</span><span style="color: #000000">, {</span>
<span style="color: #000000">                </span><span style="color: #001080">defaults:</span><span style="color: #000000"> [</span><span style="color: #A31515">&quot;a&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;b&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;c&quot;</span><span style="color: #000000">]</span>
<span style="color: #000000">            });</span>
<span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;[0]&quot;</span><span style="color: #000000">);  </span><span style="color: #008000">// &#039;a&#039;</span>
<span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #795E26">set</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;[1]&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;b2&quot;</span><span style="color: #000000">);</span>
</code></pre>
				<p>However if we use child properties, it is even easier:</p>
				<pre><code class="language-js"><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">store</span><span style="color: #000000"> = </span><span style="color: #795E26">PersistentObject</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;mySettings&quot;</span><span style="color: #000000">, {</span>
<span style="color: #000000">        </span><span style="color: #001080">defaults:</span><span style="color: #000000"> {</span>
<span style="color: #000000">          </span><span style="color: #001080">values:</span><span style="color: #000000"> [</span><span style="color: #A31515">&quot;a&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;b&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;c&quot;</span><span style="color: #000000">]</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">      });</span>
<span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;values&quot;</span><span style="color: #000000">)[</span><span style="color: #098658">0</span><span style="color: #000000">];  </span><span style="color: #008000">// &#039;a&#039;</span>
<span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;values[0]&quot;</span><span style="color: #000000">);  </span><span style="color: #008000">// &#039;a&#039;</span>
<span style="color: #0070C1">S</span><span style="color: #000000">.</span><span style="color: #795E26">each</span><span style="color: #000000">(</span><span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;values&quot;</span><span style="color: #000000">), </span><span style="color: #0000FF">function</span><span style="color: #000000">(</span><span style="color: #001080">idx</span><span style="color: #000000">, </span><span style="color: #001080">obj</span><span style="color: #000000">) { ... });</span>

<span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #795E26">set</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;values[1]&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;b2&quot;</span><span style="color: #000000">);</span>
</code></pre>
				<a href="#performance-and-direct-access" id="performance-and-direct-access" style="color: inherit; text-decoration: none;">
					<h3>Performance and Direct Access</h3>
				</a>
				<p>In general, performance costs of <code>set()</code> and <code>get()</code> calls should be
					neglectable, compared to the resulting synchronization times, but in some cases
					direct access of the internal data object may be preferred.<br>
				In this case modifications must be signalled by a call to <code>setDirty()</code>.</p>
				<pre><code class="language-js"><span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #001080">_data</span><span style="color: #000000">.</span><span style="color: #001080">owner</span><span style="color: #000000"> = { </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;joe&quot;</span><span style="color: #000000">, </span><span style="color: #001080">age:</span><span style="color: #000000"> </span><span style="color: #098658">42</span><span style="color: #000000"> };</span>
<span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #001080">_data</span><span style="color: #000000">.</span><span style="color: #001080">owner</span><span style="color: #000000">.</span><span style="color: #001080">role</span><span style="color: #000000"> = </span><span style="color: #A31515">&quot;manager&quot;</span><span style="color: #000000">;</span>
<span style="color: #0000FF">delete</span><span style="color: #000000"> </span><span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #001080">_data</span><span style="color: #000000">.</span><span style="color: #001080">owner</span><span style="color: #000000">.</span><span style="color: #001080">age</span><span style="color: #000000">;</span>
<span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #795E26">setDirty</span><span style="color: #000000">();  </span><span style="color: #008000">// schedule a commit</span>
</code></pre>
				<a href="#asynchronous-operation" id="asynchronous-operation" style="color: inherit; text-decoration: none;">
					<h3>Asynchronous Operation</h3>
				</a>
				<p>By default, changed values will be commited to webStorage after a small delay
					(see <code>.commitDelay</code> option). This allows to collate sequences of multiple changes
				into one single write command.</p>
				<p>However there are situations, where this is not desirable:</p>
				<pre><code class="language-js"><span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #795E26">set</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;foo&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;bar&quot;</span><span style="color: #000000">);</span>

<span style="color: #008000">// Page reload would prevent the delayed commit from happen, so we force</span>
<span style="color: #008000">// synchronization:</span>
<span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #795E26">commit</span><span style="color: #000000">();</span>

<span style="color: #001080">location</span><span style="color: #000000">.</span><span style="color: #795E26">reload</span><span style="color: #000000">();</span>
</code></pre>
				<p>An alternative would be to disable delay completely by setting <code>commitDelay: 0</code>.</p>
				<a href="#synchronize-with-remote-endpoints" id="synchronize-with-remote-endpoints" style="color: inherit; text-decoration: none;">
					<h3>Synchronize with Remote Endpoints</h3>
				</a>
				<p>Optionally, we may specify an endpoint URL that is used to synchronize the data
				with a web server using HTTP REST requests (GET and PUT):</p>
				<pre><code class="language-js"><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">store</span><span style="color: #000000"> = </span><span style="color: #795E26">PersistentObject</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;mySettings&quot;</span><span style="color: #000000">, {</span>
<span style="color: #000000">        </span><span style="color: #001080">remote:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;persist/settings&quot;</span>
<span style="color: #000000">      });</span>

<span style="color: #001080">$</span><span style="color: #000000">.</span><span style="color: #795E26">when</span><span style="color: #000000">(</span>
<span style="color: #000000">  </span><span style="color: #008000">// Page must be loaded</span>
<span style="color: #000000">  </span><span style="color: #001080">$</span><span style="color: #000000">.</span><span style="color: #001080">ready</span><span style="color: #000000">,</span>
<span style="color: #000000">  </span><span style="color: #008000">// PersistentObject must be pulled</span>
<span style="color: #000000">  </span><span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #001080">ready</span>

<span style="color: #000000">).</span><span style="color: #795E26">done</span><span style="color: #000000">(</span><span style="color: #0000FF">function</span><span style="color: #000000">(){</span>
<span style="color: #000000">  </span><span style="color: #008000">// Page was loaded and and store has pulled the data from the remote endpoint...</span>
<span style="color: #000000">  </span><span style="color: #795E26">initPage</span><span style="color: #000000">();</span>

<span style="color: #000000">}).</span><span style="color: #795E26">fail</span><span style="color: #000000">(</span><span style="color: #0000FF">function</span><span style="color: #000000">(){</span>
<span style="color: #000000">  </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">error</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;Error loading persistent objects&quot;</span><span style="color: #000000">, </span><span style="color: #0000FF">arguments</span><span style="color: #000000">);</span>
<span style="color: #000000">});</span>
</code></pre>
				<a href="#api-reference" id="api-reference" style="color: inherit; text-decoration: none;">
					<h1>API Reference</h1>
				</a>
				<a href="#options" id="options" style="color: inherit; text-decoration: none;">
					<h3>Options</h3>
				</a>
				<p>The following options are available:</p>
				<dl>
					<dt>commitDelay</dt>
					<dd>
						Type: <code>int</code>,
						default: <code>500</code> milliseconds<br>
						Commit cached changes to localStorage after 0.5 seconds of inactivity.<br>
						After each change, we wait 0.5 more seconds for additional changes to come
						in, before the actual commit is executed.<br>
						The maximum delay (first change until actual commit) is limited by
						`maxCommitDelay`.<br>
						Set to <code>0</code> to force synchronous mode.
					</dd>
					<dt>debugLevel</dt>
					<dd>
						Type: <code>int</code>,
						default: <code>1</code><br>
						Verbosity level: 0:quiet, 1:normal, 2:verbose.
					</dd>
					<dt>defaults</dt>
					<dd>
						Type: <code>object</code>,
						default: <code>{}</code><br>
						Default value if no data is found in localStorage.
					</dd>
					<dt>maxCommitDelay</dt>
					<dd>
						Type: <code>int</code>,
						default: <code>3000</code> milliseconds<br>
						Commit every change max. 3 seconds after it occurred.
					</dd>
					<dt>maxPushDelay</dt>
					<dd>
						Type: <code>int</code>,
						default: <code>30000</code> milliseconds<br>
						Push every commit to remote max. 30 seconds after it occurred.
					</dd>
					<dt>pushDelay</dt>
					<dd>
						Type: <code>int</code>,
						default: <code>5000</code> milliseconds<br>
						Push commits to remote after 5 seconds of inactivity.<br>
						After each change, we wait 5 more seconds for additional changes to come
						in, before the actual push is executed.<br>
						The maximum delay (first change until actual push) is limited by `maxPushDelay`.<br>
						Set to <code>0</code> to force synchronous mode.
					</dd>
					<dt>remote</dt>
					<dd>
						Type: <code>string</code>,
						default: <code>null</code><br>
						URL for GET/PUT request. Pass `null` to disable remote synchronization.
					</dd>
					<dt>storage</dt>
					<dd>
						Type: <code>object</code>,
						default: <code>window.localStorage</code><br>
						Instance of [Web Storage](https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API).<br>
						Possible values are `window.localStorage`, `window.sessionStorage`.<br>
						Pass `null` to disable persistence.
					</dd>
				</dl>
				<a href="#methods" id="methods" style="color: inherit; text-decoration: none;">
					<h3>Methods</h3>
				</a>
				<p>Following a list of available methods:</p>
				<dl>
					<dt>commit()</dt>
					<dd>
						Write modified data to localStorage.<br>
						(Normally there is no need to call this method, since it is triggered internally
						after a short collation interval.)
					</dd>
					<dt>get(key)</dt>
					<dd>
						Return a data property value (`key` supports dot notation).
					</dd>
					<dt>isDirty()</dt>
					<dd>
						Return *true* if there are uncommited or unpushed modifications.
					</dd>
					<dt>isReady()</dt>
					<dd>
						Return true if initial pull has completed.<br>
						See also the `store.ready` promise, that is resolved accordingly.
					</dd>
					<dt>pull()</dt>
					<dd>
						Download  data from the cloud, then call `.update()`.
					</dd>
					<dt>push()</dt>
					<dd>
						Commit, then upload data into the cloud.<br>
						(Normally there is no need to call this method, since it is triggered internally.)
					</dd>
					<dt>readFromForm(form, [options])</dt>
					<dd>
						Read data properties from form input elements with the same name.<br>
						Supports elements of input (type: text, radio, checkbox), textarea,
						and select.<br>
						*form* may be a form element or selector string. Example: `"#myForm"`.<br>
						*options* is optional and defaults to <code>{addNew: false, coerce: true, trim: true}</code>.
					</dd>
					<dt>remove(key)</dt>
					<dd>
						Delete object property and set the `dirty` flag (`key` supports dot notation).
					</dd>
					<dt>reset(newData)</dt>
					<dd>
						Replace data object with a new instance and set the `dirty` flag.
						*newData* is optional and defaults to <code>{}</code>.
					</dd>
					<dt>set(key, value)</dt>
					<dd>
						Modify object property and set the `dirty` flag (`key` supports dot notation).<br>
						*value* must be [convertible to JSON](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify).
					</dd>
					<dt>setDirty()</dt>
					<dd>
						Flag object as *modified*, so that commit / push will be scheduled.
					</dd>
					<dt>update()</dt>
					<dd>
						Load data from localStorage.
					</dd>
					<dt>writeToForm(form)</dt>
					<dd>
						Write data to form elements with the same name.<br>
						*form* may be a form selector or jQuery object. Example: `"#myForm"`.
					</dd>
				</dl>
				<a href="#events" id="events" style="color: inherit; text-decoration: none;">
					<h3>Events</h3>
				</a>
				<p>Events may be handled by passing a handler callback option:</p>
				<pre><code class="language-js"><span style="color: #001080">store</span><span style="color: #000000"> = </span><span style="color: #795E26">PersistentObject</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;mySettings&quot;</span><span style="color: #000000">, {</span>
<span style="color: #000000">          </span><span style="color: #001080">[</span><span style="color: #000000">...</span><span style="color: #001080">]</span>
<span style="color: #001080">          change:</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000">(</span><span style="color: #001080">hint</span><span style="color: #000000">){</span>
<span style="color: #000000">            </span><span style="color: #795E26">alert</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;Store &quot;</span><span style="color: #000000"> + </span><span style="color: #0000FF">this</span><span style="color: #000000"> + </span><span style="color: #A31515">&quot; was changed. Reason: &quot;</span><span style="color: #000000"> + </span><span style="color: #001080">hint</span><span style="color: #000000">);</span>
<span style="color: #000000">          }</span>
<span style="color: #000000">        });</span>
</code></pre>
				<p><strong>Note:</strong>
				Events are not yet finally implemented and subject to change!</p>
				<p>This is what we have so far:</p>
				<pre><code class="language-js"><span style="color: #000000">{</span>
<span style="color: #000000">    change: </span><span style="color: #001080">$</span><span style="color: #000000">.</span><span style="color: #001080">noop</span><span style="color: #000000">,</span>
<span style="color: #000000">    commit: </span><span style="color: #001080">$</span><span style="color: #000000">.</span><span style="color: #001080">noop</span><span style="color: #000000">,</span>
<span style="color: #000000">    conflict: </span><span style="color: #001080">$</span><span style="color: #000000">.</span><span style="color: #001080">noop</span><span style="color: #000000">,</span>
<span style="color: #000000">    error: </span><span style="color: #001080">$</span><span style="color: #000000">.</span><span style="color: #001080">noop</span><span style="color: #000000">,</span>
<span style="color: #000000">    pull: </span><span style="color: #001080">$</span><span style="color: #000000">.</span><span style="color: #001080">noop</span><span style="color: #000000">,</span>
<span style="color: #000000">    push: </span><span style="color: #001080">$</span><span style="color: #000000">.</span><span style="color: #001080">noop</span><span style="color: #000000">,</span>
<span style="color: #000000">    ready: </span><span style="color: #0070C1">PROMISE</span>
<span style="color: #000000">    update: </span><span style="color: #001080">$</span><span style="color: #000000">.</span><span style="color: #001080">noop</span>
<span style="color: #000000">}</span>
</code></pre>
				<!--
Following a list of available events:

<dl>
<dt>change(hint)</dt>
<dd>
    Triggered just before the popup menu is opened.<br>
    Return <code>false</code> to prevent opening.<br>
    This is also a good place to modify the menu (i.e. hiding, disabling, or
    renaming entries, or replace the menu altogether).
</dd>
</dd>
</dl>
-->
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="modules.html">Exports</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
					<li class=" tsd-kind-class">
						<a href="classes/persistentobject.html" class="tsd-kind-icon">Persistent<wbr>Object</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/persistooptions.html" class="tsd-kind-icon">Persisto<wbr>Options</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>